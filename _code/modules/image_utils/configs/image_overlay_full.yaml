# ============================================================================
# ImageOverlay - Complete Configuration Example
# ============================================================================
# 모든 가능한 정책 옵션을 포함한 전체 예제입니다.
# 실제 사용시에는 필요한 항목만 선택하여 사용하세요.

overlay:
  # --------------------------------------------------------------------------
  # 1. Source - 소스 이미지 설정
  # --------------------------------------------------------------------------
  source:
    path: "input/base.jpg"
    must_exist: false
    convert_mode: "RGB"
  
  # --------------------------------------------------------------------------
  # 2. Texts - 텍스트 오버레이 목록
  # --------------------------------------------------------------------------
  texts:
    - text: "Hello World"               # 오버레이할 텍스트
      polygon:                          # 다각형 좌표 [(x,y), ...]
        - [10, 10]
        - [200, 10]
        - [200, 50]
        - [10, 50]
      
      # 폰트 설정 (FontPolicy 필드만)
      font:
        family: "NanumGothic"           # 폰트 패밀리 또는 경로 (None = Pillow 기본)
        size: 24                        # 폰트 크기 (픽셀 단위, None = auto-fit)
        fill: "#FFFFFF"                 # 텍스트 색상 (hex)
        stroke_fill: "#000000"          # 외곽선 색상 (None = 외곽선 없음)
        stroke_width: 2                 # 외곽선 두께 (픽셀)
      
      # 텍스트 배치 설정
      anchor: "mm"                      # PIL 앵커: mm(중앙), lt(왼쪽상단) 등
      offset: [0.0, 0.0]                # 위치 오프셋 [dx, dy]
      max_width_ratio: 0.95             # bbox 내 최대 텍스트 너비 비율
    
    - text: "Second Text"
      polygon:
        - [50, 100]
        - [300, 100]
        - [300, 150]
        - [50, 150]
      font:
        family: "Arial"
        size: 18
        fill: "#0000FF"                 # 파란색
        stroke_fill: "#FFFFFF"          # 흰색 외곽선
        stroke_width: 1
      anchor: "lt"                      # 왼쪽 상단
      offset: [5.0, 5.0]
      max_width_ratio: 0.9
  
  # --------------------------------------------------------------------------
  # 3. Background Opacity - 배경 투명도
  # --------------------------------------------------------------------------
  background_opacity: 0.0               # 전체 배경 투명도 (0.0-1.0)
  
  # --------------------------------------------------------------------------
  # 4. Save - 이미지 저장 설정 (FSO 기반)
  # --------------------------------------------------------------------------
  save:
    save_copy: true                     # 오버레이된 이미지 저장
    directory: "output/overlay"
    
    name:
      as_type: "file"
      prefix: null
      name: ""
      suffix: "_overlay"
      tail: null
      extension: null
      delimiter: "_"
      tail_mode: "counter"
      date_format: "%Y-%m-%d"
      counter_width: 3
      auto_expand: true
      tail_suffix: null
      sanitize: true
      case: "keep"
      ensure_unique: true
    
    ops:
      as_type: "file"
      exist:
        must_exist: false
        create_if_missing: true
        overwrite: false
      ext:
        require_ext: false
        default_ext: null
        allowed_exts: null
    
    format: null
    quality: 95
  
  # --------------------------------------------------------------------------
  # 5. Meta - 메타데이터 저장 설정
  # --------------------------------------------------------------------------
  meta:
    save_meta: true
    directory: null
    
    name:
      as_type: "file"
      prefix: null
      name: ""
      suffix: "_overlay"
      tail: null
      extension: ".json"
      delimiter: "_"
      tail_mode: null
      date_format: "%Y-%m-%d"
      counter_width: 3
      auto_expand: true
      tail_suffix: null
      sanitize: true
      case: "keep"
      ensure_unique: false
    
    ops:
      as_type: "file"
      exist:
        must_exist: false
        create_if_missing: true
        overwrite: true
      ext:
        require_ext: false
        default_ext: ".json"
        allowed_exts: null
  
  # --------------------------------------------------------------------------
  # 6. Log - 로그 설정
  # --------------------------------------------------------------------------
  log:
    level: "INFO"
    format: "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <level>{message}</level>"
    colorize: true
    serialize: false
    backtrace: false
    diagnose: false
    enqueue: false
    catch: true
    
    handlers:
      - sink: "output/logs/image_overlay_{time:YYYY-MM-DD}.log"
        level: "DEBUG"
        format: "{time:YYYY-MM-DD HH:mm:ss} | {level: <8} | {message}"
        rotation: "1 day"
        retention: "7 days"
        compression: "zip"
        encoding: "utf-8"
        colorize: false
        serialize: false
        backtrace: true
        diagnose: false
        enqueue: false
        catch: true
